# Tuition Fee Dashboard from MyTCAS
# tuition_dashboard

  โปรเจกต์นี้เป็นโซลูชันที่ใช้ Python สำหรับการดึงข้อมูลหลักสูตรจากเว็บไซต์ MyTCAS, วิเคราะห์ข้อมูล และแสดงผลผ่านแดชบอร์ดแบบโต้ตอบที่สร้างด้วย Dash เครื่องมือนี้มีประโยชน์อย่างยิ่งสำหรับนักเรียนหรือนักวิจัยที่สนใจเปรียบเทียบหลักสูตร ค่าเล่าเรียน และรายละเอียดอื่น ๆ ที่เกี่ยวข้องของมหาวิทยาลัยต่าง ๆ ในประเทศไทย

คุณสมบัติ
 - โปรแกรมดึงข้อมูลเว็บ (Web Scraper): ใช้ไลบรารี playwright เพื่อดึงรายละเอียดหลักสูตร (ชื่อหลักสูตร, มหาวิทยาลัย, คณะ, ค่าเล่าเรียน, ประเภทหลักสูตร) จากเว็บไซต์ MyTCAS โดยอิงจากคำค้นที่ระบุ
 - การประมวลผลข้อมูล: ทำความสะอาดและจัดโครงสร้างข้อมูลที่ดึงมาได้ แปลงค่าเล่าเรียนให้อยู่ในรูปแบบตัวเลขเพื่อการวิเคราะห์
 - แดชบอร์ดแบบโต้ตอบ: สร้างด้วย Dash และ Plotly นำเสนอส่วนต่อประสานกับผู้ใช้ที่เป็นมิตร เพื่อ:
     - กรองหลักสูตรตามประเภทหลักสูตร (คำค้น), มหาวิทยาลัย และคณะ
     - ดูค่าเล่าเรียนเฉลี่ยของมหาวิทยาลัยต่าง ๆ
     - เปรียบเทียบค่าเล่าเรียนของหลักสูตรที่เลือกแบบเคียงข้างกัน
     - แสดงตารางรายละเอียดของหลักสูตรทั้งหมดที่ถูกกรอง พร้อมความสามารถในการจัดเรียงและกรอง
 - การส่งออกข้อมูล: บันทึกข้อมูลที่ดึงมาได้โดยอัตโนมัติในรูปแบบไฟล์ Excel และ CSV

**ข้อกำหนดเบื้องต้น**
- Python 3.8+
- pip (ตัวติดตั้งแพ็กเกจ Python)

**การติดตั้ง**
1. โคลน repository
  - git clone <repository_url>
  - cd <repository_folder>

2. สร้างสภาพแวดล้อมเสมือน (แนะนำ)
  - python -m venv venv
  - source venv/bin/activate  # บน Windows ใช้ `venv\Scripts\activate`

3. ติดตั้งแพ็กเกจ Python ที่จำเป็น
   - pip install -r requirements.txt

4. ติดตั้งเบราว์เซอร์สำหรับ Playwright
   - playwright install

**การใช้งาน**
โปรเจกต์นี้ประกอบด้วยสองส่วนหลัก
- โปรแกรมดึงข้อมูล (scraper)
- แดชบอร์ด Dash

**1.การเรียกใช้โปรแกรมดึงข้อมูล**
ในการรวบรวมข้อมูล ให้เรียกใช้สคริปต์โปรแกรมดึงข้อมูล ซึ่งจะเปิดใช้งานอินเทอร์เฟซบรรทัดคำสั่งเพื่อเลือกคำค้น
python your_script_name.py  # แทนที่ 'your_script_name.py' ด้วยชื่อไฟล์จริงหากแตกต่างกัน
คุณจะได้รับแจ้งให้เลือกคำค้น

=== MyTCAS Scraper ===
เลือกคำค้น:
1) วิศวกรรม ปัญญาประดิษฐ์
2) วิศวกรรม คอมพิวเตอร์
3) ทั้งสองคำ
4) กำหนดเอง
เลือก (1-4):

  หลังจากกระบวนการดึงข้อมูลเสร็จสิ้น ไฟล์ชื่อ mytcas_scraped_YYYYMMDD_HHMMSS.xlsx (และไฟล์ .csv ที่เทียบเท่า) จะถูกบันทึกในไดเรกทอรีโปรเจกต์ของคุณ ไฟล์นี้จะถูกใช้โดยแดชบอร์ดโดยอัตโนมัติ เพื่อให้แอป Dash ทำงานได้อย่างถูกต้อง เปลี่ยนชื่อไฟล์ .xlsx ที่สร้างขึ้นเป็น mytcas_scrape.xlsx หากคุณต้องการให้แดชบอร์ดโหลดข้อมูลล่าสุดโดยอัตโนมัติ

**2. การเรียกใช้แดชบอร์ด Dash**

  แดชบอร์ด Dash จะโหลดข้อมูลจาก mytcas_scrape.xlsx โดยอัตโนมัติ ตรวจสอบให้แน่ใจว่าไฟล์นี้อยู่ในไดเรกทอรีเดียวกันกับสคริปต์ของคุณหลังจากดึงข้อมูล
ในการเริ่มต้นแดชบอร์ด ให้เรียกใช้สคริปต์เดียวกัน

  python your_script_name.py  
หากข้อมูลโหลดสำเร็จ คุณจะเห็นข้อความระบุว่าแอป Dash กำลังทำงานอยู่ โดยปกติจะอยู่ที่ http://127.0.0.1:8050/ เปิด URL นี้ในเว็บเบราว์เซอร์ของคุณเพื่อเข้าถึงแดชบอร์ดแบบโต้ตอบ

ส่วนต่อประสานแดชบอร์ด
  - ตัวเลือกตัวกรอง:
      - เลือกประเภทหลักสูตร: กรองตามประเภทหลักสูตรกว้าง ๆ (เช่น "วิศวกรรมคอมพิวเตอร์", "วิศวกรรมปัญญาประดิษฐ์")
      - เลือกมหาวิทยาลัย: เลือกหนึ่งมหาวิทยาลัยหรือมากกว่าเพื่อจำกัดผลลัพธ์
      - เลือกคณะ: กรองเพิ่มเติมตามคณะเฉพาะภายในมหาวิทยาลัยที่เลือก
      - เลือกหลักสูตรที่ต้องการเปรียบเทียบค่าเทอม: ใช้ดรอปดาวน์นี้เพื่อเลือกหลักสูตรแต่ละรายการสำหรับการเปรียบเทียบค่าเล่าเรียนโดยละเอียดในแผนภูมิแท่ง
  - ข้อมูลสรุปค่าเทอม: ให้สถิติโดยย่อเกี่ยวกับหลักสูตรที่เลือก รวมถึงจำนวนหลักสูตร ค่าเล่าเรียนเฉลี่ย และค่าเล่าเรียนต่ำสุด/สูงสุดพร้อมหลักสูตรที่เกี่ยวข้อง
  - ค่าเทอมเฉลี่ยภาพรวม: แผนภูมิแท่งแสดงค่าเล่าเรียนเฉลี่ยต่อมหาวิทยาลัยตามตัวกรองปัจจุบันของคุณ
  - กราฟเปรียบเทียบค่าเทอม: แสดงแผนภูมิแท่งเปรียบเทียบค่าเล่าเรียนของหลักสูตรเฉพาะที่คุณเลือกในดรอปดาวน์ "เลือกหลักสูตรที่ต้องการเปรียบเทียบค่าเทอม"
  - รายละเอียดหลักสูตรทั้งหมด: ตารางที่สามารถค้นหาและจัดเรียงได้ ซึ่งแสดงหลักสูตรทั้งหมดที่ตรงกับตัวกรองที่คุณใช้

โครงสร้างโปรเจกต์
.
├── your_script_name.py     # สคริปต์หลักประกอบด้วยทั้งโปรแกรมดึงข้อมูลและแอป Dash
├── mytcas_scrape.xlsx      # (สร้างขึ้น) ไฟล์ Excel ที่มีข้อมูลที่ดึงมาได้ (เปลี่ยนชื่อผลลัพธ์ให้เป็นชื่อนี้)
├── mytcas_scraped_YYYYMMDD_HHMMSS.xlsx # (สร้างขึ้น) ข้อมูลที่ดึงมาพร้อม timestamp
├── mytcas_scraped_YYYYMMDD_HHMMSS.csv  # (สร้างขึ้น) ข้อมูลที่ดึงมาในรูปแบบ CSV
└── requirements.txt        # (ไม่บังคับ) รายการ dependency ของ Python

**การแก้ไขปัญหา**
  - ไม่พบข้อผิดพลาด mytcas_scrape.xlsx:
  - ตรวจสอบให้แน่ใจว่าคุณได้เรียกใช้โปรแกรมดึงข้อมูลอย่างน้อยหนึ่งครั้ง
  - หลังจากดึงข้อมูล เปลี่ยนชื่อไฟล์ผลลัพธ์ (เช่น mytcas_scraped_20231027_153000.xlsx) เป็น mytcas_scrape.xlsx เพื่อให้แดชบอร์ดค้นหาได้
  - ตรวจสอบให้แน่ใจว่าไฟล์ mytcas_scrape.xlsx อยู่ในไดเรกทอรีเดียวกันกับสคริปต์ Python ของคุณ
  - ปัญหาเบราว์เซอร์ Playwright: เรียกใช้ playwright install ในเทอร์มินัลของคุณ
  - แดชบอร์ดไม่โหลด/ว่างเปล่า: ตรวจสอบคอนโซลของคุณสำหรับข้อผิดพลาดที่เกี่ยวข้องกับ Python หรือ Dash ตรวจสอบให้แน่ใจว่าคำสั่ง pip install ทั้งหมดเสร็จสมบูรณ์ หากตั้งค่า debug=True ใน app.run() ข้อผิดพลาดโดยละเอียดจะปรากฏในคอนโซลของนักพัฒนาของเบราว์เซอร์
  - ข้อมูลไม่สอดคล้องกัน: กระบวนการดึงข้อมูลขึ้นอยู่กับโครงสร้าง HTML ที่เฉพาะเจาะจง หากเว็บไซต์ MyTCAS เปลี่ยนแปลง ตัวเลือก (selectors) (dt:has-text('ค่าใช้จ่าย') + dd, ul.t-programs > li เป็นต้น) อาจต้องได้รับการอัปเดตในคลาส MyTCASScraper
  - หาก clone git ไปแล้วไม่เอจไฟล์ mytcas_scrape.xlsx ให้ cd  เข้าโฟลเดอร์ tuition_dashboard ก่อน หรือ copy path จาก PC ของคุณ
  - พบเจอปัญหา ติดต่อ aroundthegreat@gmail.com
    
